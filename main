local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")
local TeleportService = game:GetService("TeleportService")
local CoreGui = game:GetService("CoreGui")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local LocalPlayer = Players.LocalPlayer

local function GetSafeGui()
    if gethui then return gethui() end
    if CoreGui then return CoreGui end
    return LocalPlayer:WaitForChild("PlayerGui")
end

local parentGui = GetSafeGui()

local COLORS = {
    BG = Color3.fromRGB(16, 24, 39),
    STROKE = Color3.fromRGB(56, 189, 248),
    TEXT = Color3.fromRGB(241, 245, 249),
    ACCENT = Color3.fromRGB(34, 211, 238),
    BTN_BG = Color3.fromRGB(30, 41, 59),
    CARD_BG = Color3.fromRGB(10, 10, 15),
    TOGGLE_ON = Color3.fromRGB(34, 211, 238),
    TOGGLE_OFF = Color3.fromRGB(40, 45, 60),
    HOVER_MIN = Color3.fromRGB(0, 190, 255),
    HOVER_CLOSE = Color3.fromRGB(255, 0, 0),
    NEON_GREEN = Color3.fromRGB(0, 255, 0)
}

-- Estados
_G.WalkSpeedValue = 16
_G.WalkSpeedEnabled = false
_G.AutoPurchase = false
_G.SelectedBrainrots = {}

if parentGui:FindFirstChild("ChinelaoPremium_V3_Final") then
    parentGui:FindFirstChild("ChinelaoPremium_V3_Final"):Destroy()
end

local sg = Instance.new("ScreenGui")
sg.Name = "ChinelaoPremium_V3_Final"
sg.ResetOnSpawn = false
sg.Parent = parentGui

-- [[ BOTÃO MINIMIZADO ]] --
local OpenBtn = Instance.new("ImageButton", sg)
OpenBtn.AnchorPoint = Vector2.new(0.5, 0.5)
OpenBtn.Size = UDim2.fromOffset(60, 60)
OpenBtn.Position = UDim2.new(0, 50, 0.5, 0)
OpenBtn.BackgroundColor3 = Color3.fromRGB(5, 10, 20)
OpenBtn.Visible = false
Instance.new("UICorner", OpenBtn).CornerRadius = UDim.new(0, 12)
local obs = Instance.new("UIStroke", OpenBtn)
obs.Color = COLORS.ACCENT; obs.Thickness = 2

local OpenText = Instance.new("TextLabel", OpenBtn)
OpenText.Size = UDim2.new(1, 0, 1, 0); OpenText.BackgroundTransparency = 1
OpenText.Text = "CHINELAO\nHUB"; OpenText.TextColor3 = COLORS.ACCENT; OpenText.Font = Enum.Font.GothamBlack; OpenText.TextSize = 10

-- [[ FRAME PRINCIPAL ]] --
local Main = Instance.new("Frame", sg)
Main.AnchorPoint = Vector2.new(0.5, 0.5); Main.Size = UDim2.fromOffset(550, 350)
Main.Position = UDim2.new(0.5, 0, 0.5, 0); Main.BackgroundColor3 = COLORS.BG; Main.ClipsDescendants = true
Instance.new("UICorner", Main).CornerRadius = UDim.new(0, 15)
Instance.new("UIStroke", Main).Color = COLORS.STROKE

local PanelTitle = Instance.new("TextLabel", Main)
PanelTitle.Size = UDim2.new(0, 250, 0, 50); PanelTitle.Position = UDim2.new(0, 20, 0, 0); PanelTitle.BackgroundTransparency = 1
PanelTitle.Text = "CHINELÃO PREMIUM"; PanelTitle.TextColor3 = COLORS.TEXT; PanelTitle.Font = Enum.Font.GothamBold; PanelTitle.TextSize = 18; PanelTitle.TextXAlignment = 0

-- Animação
local function CleanAnimate(gui, show)
    local targetSize = (gui == Main) and UDim2.fromOffset(550, 350) or UDim2.fromOffset(60, 60)
    if show then
        gui.Size = UDim2.fromOffset(0, 0); gui.Visible = true
        TweenService:Create(gui, TweenInfo.new(0.3, Enum.EasingStyle.Back), {Size = targetSize}):Play()
    else
        local tween = TweenService:Create(gui, TweenInfo.new(0.2, Enum.EasingStyle.Sine), {Size = UDim2.fromOffset(0, 0)})
        tween:Play(); tween.Completed:Connect(function() gui.Visible = false end)
    end
end

-- Botões de Controle
local function createTopBtn(txt, pos, hov, cb)
    local b = Instance.new("TextButton", Main)
    b.Size = UDim2.fromOffset(35, 35); b.Position = UDim2.new(1, pos, 0, 10); b.BackgroundColor3 = COLORS.BTN_BG
    b.Text = txt; b.TextColor3 = COLORS.TEXT; b.Font = Enum.Font.GothamBold; Instance.new("UICorner", b).CornerRadius = UDim.new(0, 8)
    b.MouseEnter:Connect(function() TweenService:Create(b, TweenInfo.new(0.2), {BackgroundColor3 = hov}):Play() end)
    b.MouseLeave:Connect(function() TweenService:Create(b, TweenInfo.new(0.2), {BackgroundColor3 = COLORS.BTN_BG}):Play() end)
    b.MouseButton1Click:Connect(cb)
end
createTopBtn("—", -90, COLORS.HOVER_MIN, function() CleanAnimate(Main, false); task.wait(0.2); CleanAnimate(OpenBtn, true) end)
createTopBtn("X", -45, COLORS.HOVER_CLOSE, function() CleanAnimate(Main, false); task.wait(0.3); sg:Destroy() end)
OpenBtn.MouseButton1Click:Connect(function() CleanAnimate(OpenBtn, false); task.wait(0.2); CleanAnimate(Main, true) end)

-- [[ SIDEBAR ]] --
local Sidebar = Instance.new("Frame", Main)
Sidebar.Size = UDim2.new(0, 140, 1, -70); Sidebar.Position = UDim2.new(0, 15, 0, 60); Sidebar.BackgroundTransparency = 1
Instance.new("UIListLayout", Sidebar).Padding = UDim.new(0, 8)

local Container = Instance.new("Frame", Main)
Container.Size = UDim2.new(1, -185, 1, -80); Container.Position = UDim2.new(0, 170, 0, 65); Container.BackgroundTransparency = 1

local pages = {}
local function createPage(name)
    local p = Instance.new("ScrollingFrame", Container); p.Size = UDim2.new(1, 0, 1, 0); p.BackgroundTransparency = 1; p.Visible = false; p.ScrollBarThickness = 0
    Instance.new("UIListLayout", p).Padding = UDim.new(0, 8); pages[name] = p; return p
end

local function createTab(name)
    local b = Instance.new("TextButton", Sidebar)
    b.Size = UDim2.new(1, 0, 0, 35); b.BackgroundColor3 = COLORS.BTN_BG; b.Text = name; b.TextColor3 = COLORS.TEXT; b.Font = Enum.Font.GothamBold; b.TextSize = 13; Instance.new("UICorner", b).CornerRadius = UDim.new(0, 8)
    b.MouseButton1Click:Connect(function()
        for _, v in pairs(pages) do v.Visible = false end
        pages[name].Visible = true
    end)
end

-- Páginas
local pPlayer = createPage("PLAYER"); pPlayer.Visible = true
local pFarm = createPage("FARM")
local pFly = createPage("FLY")
local pServers = createPage("SERVERS")

createTab("PLAYER"); createTab("FARM"); createTab("FLY"); createTab("SERVERS")

-- [[ COMPONENTES ]] --
local function createToggle(parent, text, callback)
    local card = Instance.new("Frame", parent); card.Size = UDim2.new(1, -5, 0, 45); card.BackgroundColor3 = COLORS.CARD_BG; Instance.new("UICorner", card)
    local label = Instance.new("TextLabel", card); label.Text = text; label.Size = UDim2.new(1, -60, 1, 0); label.Position = UDim2.new(0, 12, 0, 0); label.TextColor3 = COLORS.TEXT; label.Font = Enum.Font.GothamSemibold; label.TextSize = 13; label.BackgroundTransparency = 1; label.TextXAlignment = 0
    local tgl = Instance.new("TextButton", card); tgl.Size = UDim2.fromOffset(36, 18); tgl.Position = UDim2.new(1, -45, 0.5, -9); tgl.BackgroundColor3 = COLORS.TOGGLE_OFF; tgl.Text = ""; Instance.new("UICorner", tgl).CornerRadius = UDim.new(1, 0)
    local circ = Instance.new("Frame", tgl); circ.Size = UDim2.fromOffset(14, 14); circ.Position = UDim2.new(0, 2, 0.5, -7); circ.BackgroundColor3 = Color3.new(1, 1, 1); Instance.new("UICorner", circ).CornerRadius = UDim.new(1, 0)
    local active = false
    tgl.MouseButton1Click:Connect(function()
        active = not active
        TweenService:Create(circ, TweenInfo.new(0.2), {Position = active and UDim2.new(1, -16, 0.5, -7) or UDim2.new(0, 2, 0.5, -7)}):Play()
        TweenService:Create(tgl, TweenInfo.new(0.2), {BackgroundColor3 = active and COLORS.TOGGLE_ON or COLORS.TOGGLE_OFF}):Play()
        callback(active)
    end)
end

local function createSlider(parent, text, min, max, default, callback)
    local card = Instance.new("Frame", parent); card.Size = UDim2.new(1, -5, 0, 65); card.BackgroundColor3 = COLORS.CARD_BG; Instance.new("UICorner", card)
    local title = Instance.new("TextLabel", card); title.Text = text .. ": " .. default; title.Size = UDim2.new(1, 0, 0, 30); title.Position = UDim2.new(0, 12, 0, 5); title.TextColor3 = COLORS.NEON_GREEN; title.Font = Enum.Font.GothamBold; title.TextSize = 13; title.BackgroundTransparency = 1; title.TextXAlignment = 0
    local sbg = Instance.new("Frame", card); sbg.Size = UDim2.new(1, -30, 0, 4); sbg.Position = UDim2.new(0, 15, 0, 45); sbg.BackgroundColor3 = COLORS.TOGGLE_OFF; Instance.new("UICorner", sbg)
    local fill = Instance.new("Frame", sbg); fill.Size = UDim2.new((default-min)/(max-min), 0, 1, 0); fill.BackgroundColor3 = COLORS.NEON_GREEN; Instance.new("UICorner", fill)
    local btn = Instance.new("TextButton", sbg); btn.Size = UDim2.fromOffset(12, 12); btn.Position = UDim2.new((default-min)/(max-min), -6, 0.5, -6); btn.Text = ""; btn.BackgroundColor3 = Color3.new(1,1,1); Instance.new("UICorner", btn)
    local drag = false
    local function up()
        local p = math.clamp((UserInputService:GetMouseLocation().X - sbg.AbsolutePosition.X) / sbg.AbsoluteSize.X, 0, 1)
        fill.Size = UDim2.new(p, 0, 1, 0); btn.Position = UDim2.new(p, -6, 0.5, -6)
        local v = math.floor(min + (max - min) * p); title.Text = text .. ": " .. v; callback(v)
    end
    btn.InputBegan:Connect(function(i) if i.UserInputType == Enum.UserInputType.MouseButton1 then drag = true end end)
    UserInputService.InputEnded:Connect(function(i) if i.UserInputType == Enum.UserInputType.MouseButton1 then drag = false end end)
    UserInputService.InputChanged:Connect(function(i) if drag and i.UserInputType == Enum.UserInputType.MouseMovement then up() end end)
end

-- [[ CONTEÚDO DAS ABAS ]] --

-- PLAYER
createToggle(pPlayer, "Auto Purchase (Buy Items)", function(s) _G.AutoPurchase = s end)
createToggle(pPlayer, "WalkSpeed Hack", function(s) _G.WalkSpeedEnabled = s end)
createSlider(pPlayer, "Speed", 16, 300, 16, function(v) _G.WalkSpeedValue = v end)
createToggle(pPlayer, "Instant Grab", function(s) if s then loadstring(game:HttpGet("https://pastefy.app/CMe2Qy23/raw"))() end end)

-- FARM
local list = {"pipi potato", "tung tung tung", "sahur", "tim cheease", "lirililarila", "fluri flura", "cacto", "hipopotamo"}
for _, item in pairs(list) do
    createToggle(pFarm, "Farm: " .. item, function(s)
        if s then table.insert(_G.SelectedBrainrots, item) else
            for i,v in pairs(_G.SelectedBrainrots) do if v == item then table.remove(_G.SelectedBrainrots, i) end end
        end
    end)
end

-- FLY
createToggle(pFly, "Fly GUI V3", function(s)
    if s then loadstring(game:HttpGet("https://rawscripts.net/raw/Universal-Script-FLY-GUI-V3-19840"))() end
end)

-- SERVERS
local function sHop()
    local s = HttpService:JSONDecode(game:HttpGet("https://games.roblox.com/v1/games/"..game.PlaceId.."/servers/Public?sortOrder=Asc&limit=100"))
    for _,v in pairs(s.data) do if v.playing < v.maxPlayers and v.id ~= game.JobId then TeleportService:TeleportToPlaceInstance(game.PlaceId, v.id) break end end
end
local hb = Instance.new("TextButton", pServers); hb.Size = UDim2.new(1,-10,0,40); hb.BackgroundColor3 = COLORS.CARD_BG; hb.Text = "Server Hop"; hb.TextColor3 = COLORS.ACCENT; hb.Font = Enum.Font.GothamBold; Instance.new("UICorner", hb)
hb.MouseButton1Click:Connect(sHop)

-- [[ LOOPS ]] --
task.spawn(function()
    while true do task.wait(0.1)
        if _G.WalkSpeedEnabled and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
            LocalPlayer.Character.Humanoid.WalkSpeed = _G.WalkSpeedValue
        end
    end
end)

-- Dragging
local function makeDraggable(gui)
    local d, di, ds, sp
    gui.InputBegan:Connect(function(i) if i.UserInputType == Enum.UserInputType.MouseButton1 then d = true; ds = i.Position; sp = gui.Position end end)
    gui.InputChanged:Connect(function(i) if i.UserInputType == Enum.UserInputType.MouseMovement then di = i end end)
    UserInputService.InputChanged:Connect(function(i) if i == di and d then
        local delta = i.Position - ds
        gui.Position = UDim2.new(sp.X.Scale, sp.X.Offset + delta.X, sp.Y.Scale, sp.Y.Offset + delta.Y)
    end end)
    UserInputService.InputEnded:Connect(function(i) if i.UserInputType == Enum.UserInputType.MouseButton1 then d = false end end)
end
makeDraggable(Main); makeDraggable(OpenBtn)

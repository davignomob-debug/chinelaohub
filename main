--[[ 
    ü©¥ CHINEL√ÉO PREMIUM - UI REPAIR
    - Abas restauradas e fixas (PLAYER, SERVERS, FLY, HELPER)
    - Sistema de troca de abas corrigido
    - Mant√©m anima√ß√µes suaves (Sine)
]]

local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")
local TeleportService = game:GetService("TeleportService")
local CoreGui = game:GetService("CoreGui")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local LocalPlayer = Players.LocalPlayer

local function GetSafeGui()
    if gethui then return gethui() end
    if CoreGui then return CoreGui end
    return LocalPlayer:WaitForChild("PlayerGui")
end

local parentGui = GetSafeGui()

local COLORS = {
    BG = Color3.fromRGB(16, 24, 39),
    STROKE = Color3.fromRGB(56, 189, 248),
    TEXT = Color3.fromRGB(241, 245, 249),
    ACCENT = Color3.fromRGB(34, 211, 238),
    BTN_BG = Color3.fromRGB(30, 41, 59),
    CARD_BG = Color3.fromRGB(10, 10, 15),
    TOGGLE_ON = Color3.fromRGB(34, 211, 238),
    TOGGLE_OFF = Color3.fromRGB(40, 45, 60),
}

local sg = Instance.new("ScreenGui")
sg.Name = "ChinelaoPremium_UI_Fix"
sg.ResetOnSpawn = false
sg.Parent = parentGui

-- [[ BOT√ÉO MINIMIZADO ]] --
local OpenBtn = Instance.new("ImageButton", sg)
OpenBtn.AnchorPoint = Vector2.new(0.5, 0.5)
OpenBtn.Size = UDim2.fromOffset(60, 60)
OpenBtn.Position = UDim2.new(0, 50, 0.5, 0)
OpenBtn.BackgroundColor3 = Color3.fromRGB(5, 10, 20)
OpenBtn.Visible = false
Instance.new("UICorner", OpenBtn).CornerRadius = UDim.new(0, 12)
Instance.new("UIStroke", OpenBtn).Color = COLORS.ACCENT

local OpenText = Instance.new("TextLabel", OpenBtn)
OpenText.Size = UDim2.new(1, 0, 1, 0)
OpenText.BackgroundTransparency = 1
OpenText.Text = "CHINELAO\nHUB"
OpenText.TextColor3 = COLORS.ACCENT
OpenText.Font = Enum.Font.GothamBlack
OpenText.TextSize = 10

-- [[ FRAME PRINCIPAL ]] --
local Main = Instance.new("Frame", sg)
Main.AnchorPoint = Vector2.new(0.5, 0.5)
Main.Size = UDim2.fromOffset(550, 350)
Main.Position = UDim2.new(0.5, 0, 0.5, 0)
Main.BackgroundColor3 = COLORS.BG
Main.ClipsDescendants = true
Instance.new("UICorner", Main).CornerRadius = UDim.new(0, 15)
Instance.new("UIStroke", Main).Color = COLORS.STROKE

-- [[ SIDEBAR ]] --
local Sidebar = Instance.new("Frame", Main)
Sidebar.Size = UDim2.new(0, 140, 1, -70)
Sidebar.Position = UDim2.new(0, 15, 0, 60)
Sidebar.BackgroundTransparency = 1

local SidebarLayout = Instance.new("UIListLayout", Sidebar)
SidebarLayout.Padding = UDim.new(0, 8)

-- [[ CONTAINER DE P√ÅGINAS ]] --
local Container = Instance.new("Frame", Main)
Container.Size = UDim2.new(1, -185, 1, -80)
Container.Position = UDim2.new(0, 170, 0, 65)
Container.BackgroundTransparency = 1

-- [[ ANIMA√á√ïES ]] --
local function CleanAnimate(gui, show)
    local targetSize = (gui == Main) and UDim2.fromOffset(550, 350) or UDim2.fromOffset(60, 60)
    if show then
        gui.Size = UDim2.fromOffset(0, 0)
        gui.Visible = true
        TweenService:Create(gui, TweenInfo.new(0.3, Enum.EasingStyle.Sine), {Size = targetSize}):Play()
    else
        local t = TweenService:Create(gui, TweenInfo.new(0.2, Enum.EasingStyle.Sine), {Size = UDim2.fromOffset(0, 0)})
        t:Play()
        t.Completed:Connect(function() gui.Visible = false end)
    end
end

-- Bot√£o de Minimizar
local MinBtn = Instance.new("TextButton", Main)
MinBtn.Size = UDim2.fromOffset(35, 35)
MinBtn.Position = UDim2.new(1, -45, 0, 10)
MinBtn.Text = "‚Äî"
MinBtn.BackgroundColor3 = COLORS.BTN_BG
MinBtn.TextColor3 = COLORS.TEXT
Instance.new("UICorner", MinBtn)
MinBtn.MouseButton1Click:Connect(function() CleanAnimate(Main, false); task.wait(0.2); CleanAnimate(OpenBtn, true) end)
OpenBtn.MouseButton1Click:Connect(function() CleanAnimate(OpenBtn, false); task.wait(0.2); CleanAnimate(Main, true) end)

-- Gerenciador de Abas
local Pages = {}

local function createPage(name)
    local p = Instance.new("ScrollingFrame", Container)
    p.Name = name .. "Page"
    p.Size = UDim2.new(1, 0, 1, 0)
    p.BackgroundTransparency = 1
    p.Visible = false
    p.ScrollBarThickness = 0
    Instance.new("UIListLayout", p).Padding = UDim.new(0, 8)
    Pages[name] = p
    return p
end

local function createTab(name)
    local b = Instance.new("TextButton", Sidebar)
    b.Name = name .. "Tab"
    b.Size = UDim2.new(1, 0, 0, 35)
    b.Text = name
    b.BackgroundColor3 = COLORS.BTN_BG
    b.TextColor3 = COLORS.TEXT
    b.Font = Enum.Font.GothamBold
    Instance.new("UICorner", b)
    
    b.MouseButton1Click:Connect(function()
        for _, page in pairs(Pages) do page.Visible = false end
        Pages[name].Visible = true
    end)
end

local function createToggle(parent, text, callback)
    local card = Instance.new("Frame", parent)
    card.Size = UDim2.new(1, -10, 0, 50)
    card.BackgroundColor3 = COLORS.CARD_BG
    Instance.new("UICorner", card)
    
    local label = Instance.new("TextLabel", card)
    label.Text = text
    label.Size = UDim2.new(1, -60, 1, 0)
    label.Position = UDim2.new(0, 15, 0, 0)
    label.TextColor3 = COLORS.TEXT
    label.BackgroundTransparency = 1
    label.TextXAlignment = 0
    
    local tgl = Instance.new("TextButton", card)
    tgl.Size = UDim2.fromOffset(40, 20)
    tgl.Position = UDim2.new(1, -50, 0.5, -10)
    tgl.BackgroundColor3 = COLORS.TOGGLE_OFF
    tgl.Text = ""
    Instance.new("UICorner", tgl).CornerRadius = UDim.new(1, 0)
    
    local active = false
    tgl.MouseButton1Click:Connect(function()
        active = not active
        tgl.BackgroundColor3 = active and COLORS.TOGGLE_ON or COLORS.TOGGLE_OFF
        callback(active)
    end)
end

-- [[ CRIA√á√ÉO DAS ABAS ]] --
local pPlayer = createPage("PLAYER")
local pServers = createPage("SERVERS")
local pFly = createPage("FLY")
local pHelper = createPage("HELPER")

createTab("PLAYER")
createTab("SERVERS")
createTab("FLY")
createTab("HELPER")

-- P√°gina Inicial
pPlayer.Visible = true

-- [[ CONTE√öDO DAS ABAS ]] --

-- PLAYER
createToggle(pPlayer, "Instant Grab", function(s) if s then loadstring(game:HttpGet("https://pastefy.app/CMe2Qy23/raw"))() end end)

-- SERVERS
createToggle(pServers, "Server Hop", function(s)
    if s then
        local res = HttpService:JSONDecode(game:HttpGet("https://games.roblox.com/v1/games/"..game.PlaceId.."/servers/Public?limit=100"))
        for _, srv in ipairs(res.data) do if srv.playing < srv.maxPlayers and srv.id ~= game.JobId then TeleportService:TeleportToPlaceInstance(game.PlaceId, srv.id) break end end
    end
end)

-- FLY
createToggle(pFly, "Fly GUI V3", function(s) if s then loadstring(game:HttpGet("https://raw.githubusercontent.com/XNEOFF/FlyGuiV3/main/FlyGuiV3.lua"))() end end)

-- HELPER (AUTO LOAD)
createToggle(pHelper, "auto load script", function(active)
    if active then
        local queue = syn and syn.queue_teleport or queue_on_teleport or (fluxus and fluxus.queue_on_teleport)
        if queue then
            queue('loadstring(game:HttpGet("SEU_LINK_AQUI"))()')
        end
    end
end)

-- [[ DRAG ]] --
local function makeDraggable(gui)
    local dragging, dragInput, dragStart, startPos
    gui.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true; dragStart = input.Position; startPos = gui.Position
            input.Changed:Connect(function() if input.UserInputState == Enum.UserInputState.End then dragging = false end end)
        end
    end)
    gui.InputChanged:Connect(function(input) if input.UserInputType == Enum.UserInputType.MouseMovement then dragInput = input end end)
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - dragStart
            gui.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
end

makeDraggable(Main); makeDraggable(OpenBtn)
